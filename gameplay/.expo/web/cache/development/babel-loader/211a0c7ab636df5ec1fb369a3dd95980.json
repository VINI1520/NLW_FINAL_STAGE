{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\Vinicius Souza\\\\Documents\\\\react\\\\nlw_together\\\\gameplay\\\\gameplay\\\\src\\\\hooks\\\\auth.tsx\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { createContext, useContext, useState } from 'react';\nimport * as AuthSession from 'expo-auth-session';\nimport { SCOPE, CLIENT_ID, REDIRECT_URI, RESPONSE_TYPE } from \"../configs\";\nimport { api } from \"../services/api\";\nexport var AuthContext = createContext({});\n\nfunction AuthProvider(_ref) {\n  var children = _ref.children;\n\n  var _useState = useState({}),\n      _useState2 = _slicedToArray(_useState, 2),\n      user = _useState2[0],\n      setUser = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      loading = _useState4[0],\n      setloading = _useState4[1];\n\n  function signIn() {\n    var authUrl, response;\n    return _regeneratorRuntime.async(function signIn$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            setloading(true);\n            authUrl = api.defaults.baseURL + \"/oauth2/authorize?client_id=\" + CLIENT_ID + \"&redirect_uri=\" + REDIRECT_URI + \"&response_type=\" + RESPONSE_TYPE + \"&scope=\" + SCOPE;\n            console.log(authUrl);\n            response = AuthSession.startAsync({\n              authUrl: authUrl\n            });\n            console.log(response);\n            _context.next = 11;\n            break;\n\n          case 8:\n            _context.prev = 8;\n            _context.t0 = _context[\"catch\"](0);\n            throw new Error('Não foi possivel autenticar');\n\n          case 11:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[0, 8]], Promise);\n  }\n\n  return React.createElement(AuthContext.Provider, {\n    value: {\n      user: user,\n      signIn: signIn\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 9\n    }\n  }, children);\n}\n\nfunction useAuth() {\n  var context = useContext(AuthContext);\n  return context;\n}\n\nexport { AuthProvider, useAuth };","map":{"version":3,"sources":["C:/Users/Vinicius Souza/Documents/react/nlw_together/gameplay/gameplay/src/hooks/auth.tsx"],"names":["React","createContext","useContext","useState","AuthSession","SCOPE","CLIENT_ID","REDIRECT_URI","RESPONSE_TYPE","api","AuthContext","AuthProvider","children","user","setUser","loading","setloading","signIn","authUrl","defaults","baseURL","console","log","response","startAsync","Error","useAuth","context"],"mappings":";;;AAAA,OAAOA,KAAP,IAEEC,aAFF,EAGEC,UAHF,EAIEC,QAJF,QAMO,OANP;AAQA,OAAO,KAAKC,WAAZ,MAA6B,mBAA7B;AAEA,SACIC,KADJ,EAEIC,SAFJ,EAIIC,YAJJ,EAKIC,aALJ;AAQA,SAASC,GAAT;AAoBA,OAAO,IAAMC,WAAW,GAAGT,aAAa,CAAC,EAAD,CAAjC;;AAEP,SAASU,YAAT,OAAuD;AAAA,MAA/BC,QAA+B,QAA/BA,QAA+B;;AACnD,kBAAwBT,QAAQ,CAAO,EAAP,CAAhC;AAAA;AAAA,MAAOU,IAAP;AAAA,MAAaC,OAAb;;AACA,mBAA8BX,QAAQ,CAAC,KAAD,CAAtC;AAAA;AAAA,MAAOY,OAAP;AAAA,MAAgBC,UAAhB;;AAEJ,WAAeC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEQD,YAAAA,UAAU,CAAC,IAAD,CAAV;AAIME,YAAAA,OANd,GAM2BT,GAAG,CAACU,QAAJ,CAAaC,OANxC,oCAM8Ed,SAN9E,sBAMwGC,YANxG,uBAMsIC,aANtI,eAM6JH,KAN7J;AAOQgB,YAAAA,OAAO,CAACC,GAAR,CAAYJ,OAAZ;AAEMK,YAAAA,QATd,GASyBnB,WAAW,CAACoB,UAAZ,CAAuB;AAAEN,cAAAA,OAAO,EAAPA;AAAF,aAAvB,CATzB;AAUQG,YAAAA,OAAO,CAACC,GAAR,CAAYC,QAAZ;AAVR;AAAA;;AAAA;AAAA;AAAA;AAAA,kBAac,IAAIE,KAAJ,CAAU,6BAAV,CAbd;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAkBI,SACI,oBAAC,WAAD,CAAa,QAAb;AAAsB,IAAA,KAAK,EAAE;AACzBZ,MAAAA,IAAI,EAAJA,IADyB;AAEzBI,MAAAA,MAAM,EAANA;AAFyB,KAA7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAIML,QAJN,CADJ;AAQH;;AAED,SAASc,OAAT,GAAmB;AACf,MAAMC,OAAO,GAAGzB,UAAU,CAACQ,WAAD,CAA1B;AAEA,SAAOiB,OAAP;AACH;;AAED,SACIhB,YADJ,EAEIe,OAFJ","sourcesContent":["import React, \r\n{ \r\n  createContext,\r\n  useContext,\r\n  useState,\r\n  ReactNode\r\n} from 'react'\r\n\r\nimport * as AuthSession from 'expo-auth-session';\r\n\r\nimport {\r\n    SCOPE,\r\n    CLIENT_ID,\r\n    CDN_IMAGE,\r\n    REDIRECT_URI,\r\n    RESPONSE_TYPE\r\n} from '../configs'\r\n\r\nimport { api } from '../services/api';\r\n\r\ntype User = {\r\n    id: string;\r\n    username: string;\r\n    firstName: string;\r\n    avatar: string;\r\n    email: string;\r\n    token: string;\r\n  }\r\n\r\ntype AuthContextData = {\r\nuser: User;\r\nsignIn: () => Promise<void>;\r\n}\r\n\r\ntype AuthProviderProps = {\r\nchildren: ReactNode;\r\n}\r\n\r\nexport const AuthContext = createContext({} as AuthContextData);\r\n\r\nfunction AuthProvider({ children }: AuthProviderProps) {\r\n    const [user, setUser] = useState<User>({} as User);\r\n    const [loading, setloading] = useState(false);\r\n\r\nasync function signIn() {\r\n    try {\r\n        setloading(true);\r\n\r\n        //const authUrl = \"https://discord.com/api/oauth2/authorize?client_id=857628033812398102&redirect_uri=https%3A%2F%2Fauth.expo.io%2Fgameplay&response_type=token&scope=identify%20email%20connections%20guilds\"\r\n                         //https://discord.com/api/oauth2/authorize?client_id=857628033812398102&redirect_uri=https%3A%2F%2Fauth.expo.io%2Fvini1520%2Fgameplay&response_type=code&scope=identify%20email%20connections%20guilds       \r\n        const authUrl = `${api.defaults.baseURL}/oauth2/authorize?client_id=${CLIENT_ID}&redirect_uri=${REDIRECT_URI}&response_type=${RESPONSE_TYPE}&scope=${SCOPE}`;\r\n        console.log(authUrl);\r\n\r\n        const response = AuthSession.startAsync({ authUrl })\r\n        console.log(response);\r\n\r\n    } catch (error) {\r\n        throw new Error('Não foi possivel autenticar');\r\n    }\r\n}\r\n\r\n\r\n    return (\r\n        <AuthContext.Provider value={{\r\n            user,\r\n            signIn\r\n        }}>\r\n            { children }\r\n        </AuthContext.Provider>\r\n        )\r\n}\r\n\r\nfunction useAuth() {\r\n    const context = useContext(AuthContext);\r\n    \r\n    return context;\r\n}\r\n    \r\nexport {\r\n    AuthProvider,\r\n    useAuth\r\n}"]},"metadata":{},"sourceType":"module"}